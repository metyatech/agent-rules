## ビルド・テスト・実装前の確認

### 設計プロセス

実装を伴う作業では、常に以下のプロセスで設計を検討する：

1. **機能の分解**: 指示された内容を構成する機能・責務を洗い出す
2. **既存機能の確認**: 各機能について既存の汎用機能を調査する
   - 既に十分に汎用的な実装が存在する場合は、新規実装を避けて既存機能を活用する
   - 既存機能で不足がある場合のみ、拡張または新規実装を検討する
3. **汎用性の分析**: 新規実装が必要な機能について汎用性を判断する
   - UE全般で使えるか → 独立プラグイン
   - このプロジェクト内で汎用的か → プロジェクトのモジュール
   - 特定機能に固有か → その機能のモジュール内
4. **依存関係の設計**: 抽象（インターフェース）を通じた依存関係を設計する
5. **実装順序の決定**: 汎用的な機能から順に実装し、それらを組み合わせて最終的な機能を実装する

### ビルド

#### Lint エラーの扱い

Unreal Engine のプロジェクトはソースコード修正直後の lint エラーは信用せず、必ず「ビルド結果」でエラー確認を行う。

#### ビルド実行

ビルドは、コマンド `UnrealBuildRunTestScript\Fire-Build.ps1.bat --no-pause` で実行する。

- 追加指定が必要な場合は `UnrealBuildRunTestScript\Fire-Build.ps1.bat --no-pause -Configuration Development -Platform Win64` の形式で引数を渡す

#### エラー対処

エラーやビルド失敗に遭遇した際は、原因を分析して必要な修正を加え、成功が得られるまで対処を継続する（途中で放棄しない）。

すべての変更（ソースコード変更、新規ファイル作成/移動、`*.Build.cs` 変更、プラグイン/モジュール設定変更）を行った後は、必ずビルドを実行してエラーを確認し、エラーがあれば修正を継続する。

### テスト

#### 自動テスト

重要機能は AutomationSpec/Functional Tests を用意する。

#### テスト実行コマンド

AutomationSpec/Functional Test は次のコマンドで実行する。

- コマンド形式: `UnrealBuildRunTestScript\Fire-BuildAndTest.ps1.bat --no-pause -TestFilter <Filter>`
  - `<Filter>`: 実行するテストのフィルタ（例: `MySpec`、`MySpec.MyTestCase` など）

##### 最低限のテストケース

- 同期処理
- 非同期処理
- サーバ側
- クライアント側

#### テスト可能の基準

「テスト可能」と判断する基準は以下の通り：

- 期待する挙動を、手作業ではなくテスト環境から再現・観測できる（public API から呼べる、またはテスト専用の注入口がある）
- 主要な外部依存（I/O・ネットワーク・エンジン/サブシステム・時刻・乱数など）が抽象（インターフェース）越しに差し替え可能、またはテスト環境で再現可能
- 成功/失敗/境界/例外的入力をプログラム的に生成でき、結果が決定的に検証できる（タイムアウト・非決定性・グローバル状態に依存しない）
- 非同期処理は完了条件を待機でき、完了状態/結果/副作用が検証できる（必要に応じてタイムアウトやキャンセルの観測点を持つ）

#### 再現性

再現手順をログに残す。

### 実装前の確認

#### デザイン仕様の確認

デザイン仕様は複数回確認し、実装前に正確な理解を得てから作業を開始する。

#### コーディング規約の確認

コーディング規約の適用は実装開始時に全項目を確認し、後から修正が必要にならないよう先行して対応する。
